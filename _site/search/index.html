<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <title>é€²éšæœå°‹ | ç©æ¨‚èˆ‡æ´»å‹•ç­†è¨˜</title><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>é€²éšæœå°‹ | ç©æ¨‚èˆ‡æ´»å‹•ç­†è¨˜</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="é€²éšæœå°‹" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="ç´€éŒ„æ¯æ¬¡å‡ºèµ°èˆ‡åƒèˆ‡ï¼Œç•™ä¸‹å¿ƒå¾—èˆ‡åæ€" />
<meta property="og:description" content="ç´€éŒ„æ¯æ¬¡å‡ºèµ°èˆ‡åƒèˆ‡ï¼Œç•™ä¸‹å¿ƒå¾—èˆ‡åæ€" />
<link rel="canonical" href="http://localhost:4000/journal_web_25/search/" />
<meta property="og:url" content="http://localhost:4000/journal_web_25/search/" />
<meta property="og:site_name" content="ç©æ¨‚èˆ‡æ´»å‹•ç­†è¨˜" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="é€²éšæœå°‹" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"ç´€éŒ„æ¯æ¬¡å‡ºèµ°èˆ‡åƒèˆ‡ï¼Œç•™ä¸‹å¿ƒå¾—èˆ‡åæ€","headline":"é€²éšæœå°‹","url":"http://localhost:4000/journal_web_25/search/"}</script>
<!-- End Jekyll SEO tag -->
<meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Google Fonts: Inter + Playfair Display -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:ital@0;1&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="/journal_web_25/assets/css/style.css">
  <style>
  :root { --bg:#f8fafc; --text:#0f172a; --card:#fff; --muted:#64748b; }
  html.dark { --bg:#0b1220; --text:#e5e7eb; --card:#111827; --muted:#94a3b8; }
  html,body{ background:var(--bg); color:var(--text); }
  .card, .post-item{ background:var(--card); }
  </style>
</head>
<body>
<!-- SVG Icons Sprite (hidden) -->
<svg xmlns="http://www.w3.org/2000/svg" style="position:absolute;width:0;height:0;overflow:hidden" aria-hidden="true">
  <!-- å·¥ç¨‹å¸« / é½’è¼ª -->
  <symbol id="icon-engineer" viewBox="0 0 24 24">
    <path d="M12 2l1.2 2.5 2.7.4-1.9 2 0.4 2.8L12 9.1 9.6 9.7l0.4-2.8-1.9-2 2.7-.4L12 2zM7 14a5 5 0 1 1 10 0v5a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-5zm3 2h4a1 1 0 0 1 0 2h-4a1 1 0 0 1 0-2z"/>
  </symbol>

  <!-- éŠæˆ²æ‰‹æŠŠ -->
  <symbol id="icon-gamepad" viewBox="0 0 24 24">
    <path d="M6 8h12a4 4 0 0 1 3.8 5.2l-1.1 3.2A3 3 0 0 1 18 19c-1 0-1.9-.5-2.5-1.2l-.4-.5h-6.2l-.4.5A3.2 3.2 0 0 1 6 19a3 3 0 0 1-2.7-2.6L2.2 13A4 4 0 0 1 6 8zm2 2H7v1H6v1h1v1h1v-1h1v-1H8v-1zm7 .5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm3 0a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z"/>
  </symbol>

  <!-- ç›¸æ©Ÿ -->
  <symbol id="icon-camera" viewBox="0 0 24 24">
    <path d="M9 5h6l1 2h3a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h3l1-2zm3 4a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm0 2a3 3 0 1 1 0 6 3 3 0 0 1 0-6z"/>
  </symbol>

  <!-- è‘‰å­ / è‡ªç„¶ -->
  <symbol id="icon-leaf" viewBox="0 0 24 24">
    <path d="M20 4c-9 0-16 7-16 16 9 0 16-7 16-16zm-7.5 6.5c-2.8 1.4-4.7 3.2-6 5.9l1.2.6c1.1-2.3 2.6-3.9 5.1-5.1l-.3-1.4z"/>
  </symbol>

  <!-- é‡é» / åŸå¸‚ -->
  <symbol id="icon-pin" viewBox="0 0 24 24">
    <path d="M12 2a7 7 0 0 0-7 7c0 5.2 7 13 7 13s7-7.8 7-13a7 7 0 0 0-7-7zm0 9.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5z"/>
  </symbol>

  <!-- æ—¥æ›† -->
  <symbol id="icon-calendar" viewBox="0 0 24 24">
    <path d="M7 2h2v2h6V2h2v2h3a2 2 0 0 1 2 2v13a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h3V2zm14 7H3v10h18V9z"/>
  </symbol>

  <!-- å½±ç‰‡ / æ’­æ”¾ -->
  <symbol id="icon-video" viewBox="0 0 24 24">
    <path d="M3 6h12a2 2 0 0 1 2 2v1l4-2v10l-4-2v1a2 2 0 0 1-2 2H3V6zm7 3v6l5-3-5-3z"/>
  </symbol>

  <!-- æ¨™ç±¤ -->
  <symbol id="icon-tag" viewBox="0 0 24 24">
    <path d="M10 3l9 9-7 7-9-9V3h7zm-2.5 4A1.5 1.5 0 1 0 7 8.5 1.5 1.5 0 0 0 7.5 7z"/>
  </symbol>

  <!-- å¤ªé™½ / æœˆäº®ï¼ˆä¸»é¡Œï¼‰ -->
  <symbol id="icon-sun" viewBox="0 0 24 24">
    <path d="M12 4V2m0 20v-2m8-8h2M2 12h2m13.66 6.66l1.41 1.41M4.93 4.93l1.41 1.41m0 11.32l-1.41 1.41M18.07 4.93l-1.41 1.41M12 7a5 5 0 1 1 0 10 5 5 0 0 1 0-10z" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"/>
  </symbol>
  <symbol id="icon-moon" viewBox="0 0 24 24">
    <path d="M21 12.5A9 9 0 1 1 11.5 3a7 7 0 1 0 9.5 9.5z"/>
  </symbol>

  <!-- å¤–é€£ -->
  <symbol id="icon-external" viewBox="0 0 24 24">
    <path d="M14 3h7v7h-2V7.4l-8.3 8.3-1.4-1.4L17.6 6H14V3zM5 5h6v2H7v10h10v-4h2v6H5V5z"/>
  </symbol>

  <!-- GitHub -->
  <symbol id="icon-github" viewBox="0 0 24 24">
    <path d="M12 2a10 10 0 0 0-3.2 19.5c.5.1.7-.2.7-.5v-1.8c-3 .7-3.7-1.4-3.7-1.4-.5-1.2-1.1-1.5-1.1-1.5-.9-.6.1-.6.1-.6 1 .1 1.6 1 1.6 1 .9 1.6 2.5 1.1 3.2.8.1-.7.4-1.1.7-1.4-2.4-.3-5-1.2-5-5.4 0-1.2.4-2.2 1.1-3-.1-.3-.5-1.5.1-3 0 0 .9-.3 3 1.1a10.3 10.3 0 0 1 5.4 0c2.1-1.4 3-1.1 3-1.1.6 1.5.2 2.7.1 3 .7.8 1.1 1.8 1.1 3 0 4.2-2.6 5-5 5.3.4.4.7 1 .7 2v3c0 .3.2.6.7.5A10 10 0 0 0 12 2z"/>
  </symbol>

  <!-- ä¿¡å° / Email -->
  <symbol id="icon-mail" viewBox="0 0 24 24">
    <path d="M3 6h18v12H3V6zm9 6L3 8v8h18V8l-9 4z"/>
  </symbol>

  <!-- é–ƒé›» / çªç ´ -->
  <symbol id="icon-bolt" viewBox="0 0 24 24">
    <path d="M13 2L4 14h6l-1 8 9-12h-6l1-8z"/>
  </symbol>

  <!-- å¿ƒ / å–œæ­¡ -->
  <symbol id="icon-heart" viewBox="0 0 24 24">
    <path d="M12 21s-7.3-4.6-9.5-8.5A5.5 5.5 0 0 1 12 6a5.5 5.5 0 0 1 9.5 6.5C19.3 16.4 12 21 12 21z"/>
  </symbol>
</svg>

<!-- ä¸€é»é€šç”¨æ¨£å¼ -->
<style>
.icon{ width:1.1em; height:1.1em; vertical-align:-0.15em; fill:currentColor }
.icon-lg{ width:1.35em; height:1.35em }
.icon-muted{ color:#64748b }
.icon-accent{ color:#2563eb }
.icon-btn{ display:inline-flex; align-items:center; gap:.4em; padding:.45em .7em; border:1px solid #e5e7eb; border-radius:10px; text-decoration:none }
.icon-btn:hover{ background:#f8fafc }
</style>

<header class="site-header container">
  <h1 class="site-title"><a href="/journal_web_25/">ç©æ¨‚èˆ‡æ´»å‹•ç­†è¨˜</a></h1>
  <nav class="site-nav">
    <a href="/journal_web_25/">é¦–é </a> Â·
    <a href="/journal_web_25/tags">æ¨™ç±¤</a> Â·
    <a href="/journal_web_25/archive">æ­¸æª”</a> Â·
    <a href="/journal_web_25/search/">æœå°‹</a> Â·
    <a href="/journal_web_25/about">é—œæ–¼</a>
    <button id="themeToggle" class="btn-ghost" aria-label="åˆ‡æ›æ·±è‰²">ğŸŒ“</button>
  </nav>

  <hr>
</header>

<main class="site-main container">
  <h2>é€²éšæœå°‹</h2>
<p style="color:#64748b;">åŒæ™‚ç”¨ã€Œé¡å‹ã€åœ‹å®¶/ç¸£å¸‚ã€æ—¥æœŸã€æ¨™ç±¤ã€é—œéµå­—ã€éæ¿¾ã€‚æ¨™ç±¤æ”¯æ´ AND/ORã€‚</p>

<form id="searchForm" class="adv-search" style="display:grid; gap:14px; grid-template-columns: repeat(2, minmax(0,1fr)); margin:16px 0 20px;">
  <fieldset style="grid-column: 1 / -1;">
    <legend>é¡å‹</legend>
    <div id="typeBox" class="chips"></div>
  </fieldset>

  <fieldset style="grid-column: 1 / -1;">
    <legend>åœ°é»</legend>
    <div id="countryCityBox"></div>
  </fieldset>

  <fieldset>
    <legend>èµ·å§‹æ—¥æœŸ</legend>
    <input type="date" id="fromDate">
  </fieldset>
  <fieldset>
    <legend>çµæŸæ—¥æœŸ</legend>
    <input type="date" id="toDate">
  </fieldset>
  <div style="grid-column: 1 / -1; display:flex; flex-wrap:wrap; gap:8px;">
    <button type="button" class="btn-ghost" data-range="this-year">ä»Šå¹´</button>
    <button type="button" class="btn-ghost" data-range="last-30">è¿‘30å¤©</button>
    <button type="button" class="btn-ghost" data-range="clear">æ¸…é™¤æ—¥æœŸ</button>
  </div>

  <fieldset style="grid-column: 1 / -1;">
    <legend>æ¨™ç±¤</legend>
    <div style="display:flex; align-items:center; gap:12px; margin-bottom:6px;">
      <label><input type="radio" name="tagMode" value="and" checked> ANDï¼ˆåŒ…å«æ‰€æœ‰æ‰€é¸æ¨™ç±¤ï¼‰</label>
      <label><input type="radio" name="tagMode" value="or"> ORï¼ˆå…¶ä¸­ä¸€å€‹å³å¯ï¼‰</label>
    </div>
    <div id="tagsBox" class="chips"></div>
  </fieldset>

  <fieldset style="grid-column: 1 / -1;">
    <legend>é—œéµå­—</legend>
    <input type="text" id="q" placeholder="æ¨™é¡Œ / æ‘˜è¦ / åœ°é» / æ¨™ç±¤ æ¨¡ç³Šæœå°‹">
  </fieldset>

  <div style="grid-column: 1 / -1; display:flex; gap:8px;">
    <button type="submit">æœå°‹</button>
    <button type="button" id="resetBtn">æ¸…é™¤å…¨éƒ¨</button>
  </div>
</form>

<section id="results" class="posts-list"></section>

<script>
(async function(){
  const res = await fetch('/journal_web_25/posts.json', {cache:'no-store'});
  const dataRaw = await res.json();
  const data = dataRaw.map(p => ({
    ...p,
    date: (p.date || '').slice(0,10),
    start_date: (p.start_date || '').slice(0,10),
    end_date: (p.end_date || '').slice(0,10),
    type: p.type || '',
    country: p.country || '',
    city: p.city || '',
    tags: Array.isArray(p.tags) ? p.tags : []
  }));

  const typeBox = document.getElementById('typeBox');
  const countryCityBox = document.getElementById('countryCityBox');
  const tagsBox = document.getElementById('tagsBox');
  const fromDate = document.getElementById('fromDate');
  const toDate = document.getElementById('toDate');
  const qInput = document.getElementById('q');
  const form = document.getElementById('searchForm');
  const results = document.getElementById('results');
  const resetBtn = document.getElementById('resetBtn');

  const types = [...new Set(data.map(p => p.type).filter(Boolean))].sort();
  const countries = [...new Set(data.map(p => p.country).filter(Boolean))].sort();
  const tagsAll = [...new Set(data.flatMap(p => p.tags||[]))].sort((a,b)=>a.localeCompare(b,'zh-Hant'));

  const citiesByCountry = {};
  for (const p of data) {
    if (!p.country) continue;
    if (!citiesByCountry[p.country]) citiesByCountry[p.country] = new Set();
    if (p.city) citiesByCountry[p.country].add(p.city);
  }
  const countriesWithCities = countries.map(c => ({ country: c, cities: [...(citiesByCountry[c]||[])].sort((a,b)=>a.localeCompare(b,'zh-Hant')) }));

  for (const t of types) {
    const id = 'type-' + t.replace(/\s+/g,'-');
    typeBox.insertAdjacentHTML('beforeend', `<label class="chip"><input type="checkbox" value="${t}" id="${id}"><span>${t}</span></label>`);
  }

  for (const item of countriesWithCities) {
    const c = item.country;
    const cid = 'country-' + c;
    const hasCities = item.cities.length > 0;
    countryCityBox.insertAdjacentHTML('beforeend', `
      <div class="cc-group">
        <div class="cc-head">
          <label class="chip"><input type="checkbox" class="country-cb" value="${c}" id="${cid}"><span>${c}</span></label>
          ${hasCities ? `<button type="button" class="cc-toggle" aria-expanded="false">å±•é–‹</button>` : ''}
        </div>
        ${hasCities ? `
        <div class="cc-cities" hidden>
          ${item.cities.map(city => {
            const id = \`city-\${c}-\${city.replace(/\s+/g,'-')}\`;
            return \`<label class="chip sub"><input type="checkbox" class="city-cb" data-country="\${c}" value="\${city}" id="\${id}"><span>\${city}</span></label>\`
          }).join('')}
        </div>` : ''}
      </div>
    `);
  }

  countryCityBox.addEventListener('click', (e)=>{
    if (!e.target.classList.contains('cc-toggle')) return;
    const btn = e.target;
    const wrap = btn.closest('.cc-group');
    const panel = wrap.querySelector('.cc-cities');
    const expanded = btn.getAttribute('aria-expanded') === 'true';
    btn.setAttribute('aria-expanded', String(!expanded));
    btn.textContent = expanded ? 'å±•é–‹' : 'æ”¶åˆ';
    panel.hidden = expanded;
  });

  countryCityBox.addEventListener('change', (e)=>{
    const el = e.target;
    if (el.classList.contains('country-cb')) {
      const group = el.closest('.cc-group');
      group.querySelectorAll('.city-cb').forEach(cb => cb.checked = el.checked);
    } else if (el.classList.contains('city-cb')) {
      const group = el.closest('.cc-group');
      const countryCb = group.querySelector('.country-cb');
      if (el.checked) countryCb.checked = true;
      else {
        const anyChecked = [...group.querySelectorAll('.city-cb')].some(cb=>cb.checked);
        if (!anyChecked) countryCb.checked = false;
      }
    }
  });

  for (const tag of tagsAll) {
    const id = 'tag-' + tag.replace(/\s+/g,'-');
    tagsBox.insertAdjacentHTML('beforeend', `<label class="chip"><input type="checkbox" value="${tag}" id="${id}"><span>${tag}</span></label>`);
  }

  document.querySelectorAll('[data-range]').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const kind = btn.getAttribute('data-range');
      if (kind === 'this-year') {
        const d = new Date(); const y = d.getFullYear();
        fromDate.value = \`\${y}-01-01\`; toDate.value = \`\${y}-12-31\`;
      } else if (kind === 'last-30') {
        const to = new Date().toISOString().slice(0,10);
        const from = new Date(Date.now()-29*24*3600*1000).toISOString().slice(0,10);
        fromDate.value = from; toDate.value = to;
      } else { fromDate.value = ''; toDate.value = ''; }
    });
  });

  const getSelected = (selector) => [...document.querySelectorAll(selector+':checked')].map(el=>el.value);
  const tagModeRadio = () => (document.querySelector('input[name="tagMode"]:checked')?.value || 'and');

  function inRange(post, from, to){
    if (!from && !to) return true;
    const sd = post.start_date || post.date;
    const ed = post.end_date || post.date;
    if (from && ed < from) return false;
    if (to && sd > to) return false;
    return true;
  }

  function matchesKeyword(post, keyword){
    if (!keyword) return true;
    const k = keyword.toLowerCase();
    const hay = [post.title, post.summary, post.location, post.city, ...(post.tags||[])].filter(Boolean).join(' ').toLowerCase();
    return hay.includes(k);
  }

  function matches(post){
    const typesSel = getSelected('#typeBox input[type="checkbox"]');
    if (typesSel.length && !typesSel.includes(post.type)) return false;

    const countriesSel = getSelected('.country-cb');
    const citiesSel = getSelected('.city-cb');
    if (countriesSel.length) {
      if (!countriesSel.includes(post.country)) return false;
      const checkedCities = [...document.querySelectorAll('.cc-group')]
        .filter(g => g.querySelector('.country-cb').checked)
        .flatMap(g => [...g.querySelectorAll('.city-cb:checked')].map(cb => ({country: g.querySelector('.country-cb').value, city: cb.value})))
        .filter(e => e.country === post.country)
        .map(e => e.city);
      if (checkedCities.length && !checkedCities.includes(post.city)) return false;
    }

    if (!inRange(post, fromDate.value, toDate.value)) return false;

    const selectedTags = getSelected('#tagsBox input[type="checkbox"]');
    if (selectedTags.length) {
      const set = new Set(post.tags || []);
      if (tagModeRadio() === 'and') {
        for (const t of selectedTags) if (!set.has(t)) return false;
      } else {
        let ok = false; for (const t of selectedTags) if (set.has(t)) { ok = true; break; }
        if (!ok) return false;
      }
    }

    if (!matchesKeyword(post, qInput.value.trim())) return false;

    return true;
  }

  function cardHTML(p){
    const thumb = p.cover || (p.gallery && p.gallery[0]) || '/journal_web_25/assets/images/placeholder.jpg';
    const meta = [p.date, p.city || p.location || '', p.type ? p.type.toUpperCase() : ''].filter(Boolean).join(' Â· ');
    const tgs = (p.tags||[]).map(t=>`<span class="tag">#${t}</span>`).join(' ');
    return `
      <article class="post-item">
        <a href="${p.url}" aria-label="${p.title}">
          <img class="post-thumb" src="${thumb}" alt="thumbnail of ${p.title}">
        </a>
        <div>
          <h3 class="post-title"><a href="${p.url}">${p.title}</a></h3>
          <div class="post-meta">${meta}</div>
          ${p.summary ? `<p class="post-excerpt">${p.summary}</p>` : ''}
          ${tgs ? `<div class="tags">${tgs}</div>` : ''}
        </div>
      </article>
    `;
  }

  function render(list){
    if (!list.length){ results.innerHTML = `<p style="color:#64748b;">æ²’æœ‰ç¬¦åˆæ¢ä»¶çš„çµæœã€‚</p>`; return; }
    list.sort((a,b)=> (a.date < b.date ? 1 : -1));
    results.innerHTML = list.map(cardHTML).join('');
  }

  function syncURL(){
    const params = new URLSearchParams();
    const tsel = getSelected('#typeBox input[type="checkbox"]');
    const csel = getSelected('.country-cb');
    const citysel = getSelected('.city-cb');
    const tgsel = getSelected('#tagsBox input[type="checkbox"]');
    if (tsel.length) params.set('types', tsel.join(','));
    if (csel.length) params.set('countries', csel.join(','));
    if (citysel.length) params.set('cities', citysel.join(','));
    if (fromDate.value) params.set('from', fromDate.value);
    if (toDate.value) params.set('to', toDate.value);
    if (tgsel.length) params.set('tags', tgsel.join(','));
    const mode = tagModeRadio(); if (mode !== 'and') params.set('tagmode', mode);
    if (qInput.value.trim()) params.set('q', qInput.value.trim());
    history.replaceState(null,'', params.toString()? ('?'+params.toString()) : location.pathname);
  }

  function applyAndRender(){
    const filtered = data.filter(matches);
    render(filtered);
    syncURL();
  }

  form.addEventListener('submit', (e)=>{ e.preventDefault(); applyAndRender(); });
  resetBtn.addEventListener('click', ()=>{
    document.querySelectorAll('.adv-search input[type="checkbox"]').forEach(cb=>cb.checked=false);
    fromDate.value = ''; toDate.value = ''; qInput.value = '';
    document.querySelector('input[name="tagMode"][value="and"]').checked = true;
    render(data); history.replaceState(null,'', location.pathname);
  });

  const url = new URL(location.href);
  const qs = (key) => url.searchParams.get(key) || '';
  const setChecks = (container, values) => {
    if (!values.length) return;
    const set = new Set(values);
    container.querySelectorAll('input[type="checkbox"]').forEach(cb => { if (set.has(cb.value)) cb.checked = true; });
  };

  setChecks(typeBox, (qs('types')||'').split(',').filter(Boolean));
  setChecks(countryCityBox, (qs('countries')||'').split(',').filter(Boolean));
  setChecks(countryCityBox, (qs('cities')||'').split(',').filter(Boolean));
  fromDate.value = qs('from'); toDate.value = qs('to');
  setChecks(tagsBox, (qs('tags')||'').split(',').filter(Boolean));
  const tm = qs('tagmode'); if (tm) (document.querySelector(`input[name="tagMode"][value="${tm}"]`) || {}).checked = true;
  qInput.value = qs('q');

  countryCityBox.querySelectorAll('.cc-group').forEach(g=>{
    const anyCityChecked = [...g.querySelectorAll('.city-cb')].some(cb=>cb.checked);
    if (anyCityChecked) {
      const btn = g.querySelector('.cc-toggle');
      const panel = g.querySelector('.cc-cities');
      if (btn && panel) { btn.setAttribute('aria-expanded','true'); btn.textContent='æ”¶åˆ'; panel.hidden=false; }
    }
  });

  applyAndRender();
})();
</script>

</main>

<footer class="site-footer container">
  <hr>
  <p>Â© 2026 Â· Powered by GitHub Pages & Jekyll</p>
</footer>

<!-- tsParticles for hero effect (å¯ç§»é™¤) -->
<script src="https://cdn.jsdelivr.net/npm/tsparticles@3/tsparticles.bundle.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', async () => {
  const el = document.getElementById('particles-hero');
  if (!el) return;
  if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
  const engine = window.tsParticles;
  await engine.load({ id: "particles-hero", options: {
    background: { color: "transparent" },
    fullScreen: { enable: false },
    fpsLimit: 60,
    particles: {
      number: { value: 60, density: { enable: true, area: 800 } },
      color: { value: ["#60a5fa", "#93c5fd", "#fde68a"] },
      shape: { type: "circle" },
      opacity: { value: 0.5, random: true },
      size: { value: { min: 1, max: 3 } },
      links: { enable: true, distance: 120, opacity: 0.25 },
      move: { enable: true, speed: 1.2, outModes: { default: "bounce" } }
    },
    interactivity: {
      events: { onHover: { enable: true, mode: "repulse" }, onClick: { enable: true, mode: "push" }, resize: true },
      modes: { repulse: { distance: 120 }, push: { quantity: 2 } }
    },
    detectRetina: true
  }});
});

(() => {
  const key = 'pref-theme';
  const apply = v => document.documentElement.classList.toggle('dark', v==='dark');
  apply(localStorage.getItem(key) || (matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'));
  document.getElementById('themeToggle')?.addEventListener('click', () => {
    const next = document.documentElement.classList.contains('dark') ? 'light' : 'dark';
    localStorage.setItem(key, next); apply(next);
  });
})();

(() => {
  const sel = '.gallery img, .post .gallery-img';
  let items=[], idx=0, overlay;
  function open(i){
    idx=i; const src=items[idx].src;
    overlay = document.createElement('div');
    overlay.style.cssText='position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.85);z-index:9999';
    overlay.innerHTML=`<img src="${src}" style="max-width:92vw;max-height:92vh;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.5)" />`;
    document.body.appendChild(overlay);
    overlay.addEventListener('click', e=>{ if(e.target===overlay) close(); });
    window.addEventListener('keydown', onkey);
  }
  function close(){ overlay?.remove(); window.removeEventListener('keydown', onkey); }
  function onkey(e){
    if(e.key==='Escape') return close();
    if(e.key==='ArrowRight'){ idx=(idx+1)%items.length; overlay.querySelector('img').src=items[idx].src; }
    if(e.key==='ArrowLeft'){ idx=(idx-1+items.length)%items.length; overlay.querySelector('img').src=items[idx].src; }
  }
  window.addEventListener('load',()=>{
    items=[...document.querySelectorAll(sel)];
    items.forEach((img,i)=> img.addEventListener('click',()=>open(i)));
  });
})();

(() => {
  const ob=new IntersectionObserver((es)=>es.forEach(e=>{
    if(e.isIntersecting){ e.target.classList.add('show'); ob.unobserve(e.target); }
  }), {threshold:.15});
  window.addEventListener('load',()=> document.querySelectorAll('.reveal').forEach(el=>ob.observe(el)));
})();

</script>
</body>
</html>
